#!/bin/bash
# Enhanced IP Blocker Configuration with Relative Paths
# Paths are relative to installation directory

# Base directory (auto-detected)
BASE_DIR="/opt/ipblocker"

# Paths (relative to BASE_DIR)
LOG_FILE="/var/log/auth.log"
BLOCKED_DB="$BASE_DIR/blocked_ips.db"
WHITELIST_FILE="$BASE_DIR/whitelist.conf"
LAST_POSITION_FILE="$BASE_DIR/last_position.txt"
APP_LOG="$BASE_DIR/logs/ip_blocker.log"
USER_CORRELATION_DB="$BASE_DIR/user_correlation.db"

# Temporary files (in system temp)
TEMP_NEW_ENTRIES="/tmp/ip_blocker_new_entries.tmp"
TEMP_IPS="/tmp/ip_blocker_ips.tmp"
TEMP_MALICIOUS="/tmp/ip_blocker_malicious.tmp"

# Basic Settings
THRESHOLD=3
CHECK_INTERVAL=300

# Enhanced Detection Settings
GLOBAL_FAILURE_THRESHOLD=100
CONNECTION_RATIO_THRESHOLD=90
USER_CORRELATION_THRESHOLD=5
EXTENDED_WINDOW_THRESHOLD=300

# Notification Settings
SEND_EMAIL_ALERTS=false
EMAIL_RECIPIENT="reemakumari6136@gmail.com"

# Backup Settings
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=7
